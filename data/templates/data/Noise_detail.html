{% extends 'datacollection/layout.html'%}

{% block content %}
<div class="relative w-full mx-auto ">
  <!-- Breadcrumb -->
  <nav class="mb-6">
    <ol class="flex flex-wrap pt-1 mr-12 bg-transparent rounded-lg sm:mr-16">
      <li class="text-sm leading-normal">
        <a class="text-white opacity-50" href="javascript:;">Home</a>
      </li>
      <li class="text-sm pl-2 capitalize leading-normal text-white before:float-left before:pr-2 before:text-white before:content-['/']">
        <a href="{% url 'data:datasetlist' %}" class="text-white">Noise Datasets</a>
      </li>
      <li class="text-sm pl-2 capitalize leading-normal text-white before:float-left before:pr-2 before:text-white before:content-['/']" aria-current="page">
        {{ noise_dataset.name }}
      </li>
    </ol>
  </nav>

  <!-- Main Card -->
  <div class="relative flex flex-col flex-auto min-w-0 p-4 mx-6 overflow-hidden break-words bg-white border-0 dark:bg-slate-850 dark:shadow-dark-xl shadow-3xl rounded-2xl bg-clip-border">
    <div class="flex flex-wrap -mx-3">
      <div class="flex-none w-auto max-w-full px-3">
        <div class="relative inline-flex items-center justify-center text-white transition-all duration-200 ease-in-out text-base h-19 w-19 rounded-xl">
          <i class="fas fa-volume-up text-4xl text-blue-500"></i>
        </div>
      </div>
      <div class="flex-none w-auto max-w-full px-3 my-auto">
        <div class="h-full">
          <h5 class="mb-1 dark:text-white">{{ noise_dataset.name }}</h5>
          <p class="mb-0 font-semibold leading-normal dark:text-white dark:opacity-60 text-sm">
            Noise ID: {{ noise_dataset.noise_id }}
          </p>
        </div>
      </div>
      <div class="w-full max-w-full px-3 mx-auto mt-4 sm:my-auto sm:mr-0 md:w-1/2 md:flex-none lg:w-4/12">
        <div class="relative right-0">
          <div class="flex justify-end space-x-2">
            <a href="#" class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors duration-200 text-sm">
              <i class="fas fa-edit mr-2"></i>Edit
            </a>
            <a href="#" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors duration-200 text-sm">
              <i class="fas fa-trash mr-2"></i>Delete
            </a>
            <a href="{% url 'data:datasetlist' %}" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition-colors duration-200 text-sm">
              <i class="fas fa-arrow-left mr-2"></i>Back
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Content Sections -->
  <div class="w-full p-6 mx-auto">
    <div class="flex flex-wrap -mx-3">
      <!-- Left Column (8/12 width) -->
      <div class="w-full max-w-full px-3 shrink-0 md:w-8/12 md:flex-0">
        <!-- Description Card -->
        <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border mb-6">
          <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
            <div class="flex items-center">
              <p class="mb-0 dark:text-white/80">Description</p>
            </div>
          </div>
          <div class="flex-auto p-6">
            <p class="text-gray-700 dark:text-gray-300">
              {{ noise_dataset.description|default:"No description provided" }}
            </p>
          </div>
        </div>

        <!-- Audio Visualizations -->
        <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border mb-6">
          <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
            <div class="flex items-center">
              <p class="mb-0 dark:text-white/80">Audio Analysis</p>
            </div>
          </div>
          <div class="flex-auto p-6">
            <!-- Waveform Plot -->
            <div class="mb-8">
              <h6 class="text-lg font-semibold mb-4 dark:text-white">Waveform</h6>
              {{ waveform_plot|safe }}
            </div>
            
            <!-- Spectrogram Plot -->
            <div class="mb-8">
              <h6 class="text-lg font-semibold mb-4 dark:text-white">Mel Spectrogram</h6>
              {{ spectrogram_plot|safe }}
            </div>
            
            <!-- MFCC Plot -->
            <div class="mb-8">
              <h6 class="text-lg font-semibold mb-4 dark:text-white">MFCC Coefficients</h6>
              {{ mfcc_plot|safe }}
            </div>
            
            <!-- Frequency Features Plot -->
            <div>
              <h6 class="text-lg font-semibold mb-4 dark:text-white">Frequency Domain Features</h6>
              {{ freq_plot|safe }}
            </div>
          </div>
        </div>

        <!-- Information Cards -->
        <div class="grid grid-cols-1 gap-6">
          <!-- Basic Information -->
          <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border">
            <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
              <div class="flex items-center">
                <p class="mb-0 dark:text-white/80">Basic Information</p>
              </div>
            </div>
            <div class="flex-auto p-6">
              <div class="flex flex-wrap -mx-3">
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Collector</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.collector.get_f|default:noise_dataset.collector.username }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Category</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.category.name|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Class</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.class_name.name|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Sub Class</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.subclass.name|default:"-" }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Noise Analysis Metrics -->
          <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border">
            <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
              <div class="flex items-center">
                <p class="mb-0 dark:text-white/80">Noise Analysis Metrics</p>
              </div>
            </div>
            <div class="flex-auto p-6">
              <div class="flex flex-wrap -mx-3">
                <div class="w-full max-w-full px-3 shrink-0 md:w-4/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Mean dB</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_analysis.mean_db|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-4/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Max dB</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_analysis.max_db|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-4/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Min dB</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_analysis.min_db|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-4/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Dominant Frequency</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_analysis.dominant_frequency|default:"-" }} Hz
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-4/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Loudness</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_analysis.loudness|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-4/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Sharpness</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_analysis.sharpness|default:"-" }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Location Information -->
          <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border mt-6">
            <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
              <div class="flex items-center">
                <p class="mb-0 dark:text-white/80">Location Information</p>
              </div>
            </div>
            <div class="flex-auto p-6">
              <div class="flex flex-wrap -mx-3">
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Region</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.region.name|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Community</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.community.name|default:"-" }}
                    </p>
                  </div>
                </div>
                <div class="w-full max-w-full px-3 shrink-0 md:w-6/12 md:flex-0">
                  <div class="mb-4">
                    <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Time of Day</label>
                    <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                      {{ noise_dataset.time_of_day.name|default:"-" }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column (4/12 width) -->
      <div class="w-full max-w-full px-3 mt-6 shrink-0 md:w-4/12 md:flex-0 md:mt-0">
        <!-- Audio Player Card -->
        <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border mb-6">
          <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
            <div class="flex items-center">
              <p class="mb-0 dark:text-white/80">Audio Recording</p>
            </div>
          </div>
          <div class="flex-auto p-6">
            {% if noise_dataset.audio %}
              <div class="mb-4">
                <audio controls class="w-full rounded-lg">
                  <source src="{{ noise_dataset.audio.url }}" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio>
                <a href="{{ noise_dataset.audio.url }}" download class="inline-block mt-2 text-blue-500 hover:text-blue-700 text-sm">
                  <i class="fas fa-download mr-1"></i>Download Audio
                </a>
              </div>
            {% else %}
              <p class="text-gray-700 dark:text-gray-300">No audio file available</p>
            {% endif %}
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Duration</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ noise_dataset.duration|default:"-" }} seconds
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Recording Date</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ noise_dataset.recording_date|date:"F j, Y, g:i a"|default:"-" }}
              </p>
            </div>
          </div>
        </div>

        <!-- Audio Features Card -->
        <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border mb-6">
          <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
            <div class="flex items-center">
              <p class="mb-0 dark:text-white/80">Audio Features</p>
            </div>
          </div>
          <div class="flex-auto p-6">
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Spectral Centroid</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ audio_features.spectral_centroid|default:"-" }} Hz
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Spectral Bandwidth</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ audio_features.spectral_bandwidth|default:"-" }} Hz
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Spectral Rolloff</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ audio_features.spectral_rolloff|default:"-" }} Hz
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Zero Crossing Rate</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ audio_features.zero_crossing_rate|default:"-" }}
              </p>
            </div>
          </div>
        </div>

        <!-- Recording Details Card -->
        <div class="relative flex flex-col min-w-0 break-words bg-white border-0 shadow-xl dark:bg-slate-850 dark:shadow-dark-xl rounded-2xl bg-clip-border">
          <div class="border-black/12.5 rounded-t-2xl border-b-0 border-solid p-6 pb-0">
            <div class="flex items-center">
              <p class="mb-0 dark:text-white/80">Recording Details</p>
            </div>
          </div>
          <div class="flex-auto p-6">
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Recording Device</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ noise_dataset.recording_device|default:"-" }}
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Microphone Type</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ noise_dataset.microphone_type.name|default:"-" }}
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Created At</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ noise_dataset.created_at|date:"F j, Y, g:i a" }}
              </p>
            </div>
            
            <div class="mb-4">
              <label class="inline-block mb-2 ml-1 font-bold text-xs text-slate-700 dark:text-white/80">Last Updated</label>
              <p class="dark:text-white text-sm leading-5.6 ease block w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none">
                {{ noise_dataset.updated_at|date:"F j, Y, g:i a" }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Include Plotly JS -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
{% endblock %}