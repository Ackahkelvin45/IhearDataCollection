{% extends "admin/change_list.html" %}
{% load i18n admin_urls static admin_list %}

{% block object-tools-items %}
  {{ block.super }}
  {% if missing_either_count > 0 %}
    <li>
      <a href="{% url 'admin:data_noisedataset_missing_analysis' %}" class="btn">
        🔍 View Missing Analysis ({{ missing_either_count }})
      </a>
    </li>
    <li>
      <a href="{% url 'admin:data_noisedataset_redo_analysis' %}" class="btn">
        🔄 Redo All Missing Analysis
      </a>
    </li>
  {% endif %}
{% endblock %}

{% block content %}
  {% if missing_either_count > 0 %}
    <div style="margin-bottom: 20px; padding: 15px; background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px;">
      <h4 style="margin-top: 0; color: #856404;">⚠️ Missing Audio Analysis Detected</h4>
      <p style="margin-bottom: 10px;">
        <strong>{{ missing_either_count }}</strong> datasets are missing audio analysis:
      </p>
      <ul style="margin-bottom: 15px;">
        <li><strong>{{ missing_audio_features_count }}</strong> missing audio features</li>
        <li><strong>{{ missing_noise_analysis_count }}</strong> missing noise analysis</li>
      </ul>
      <div>
        <a href="{% url 'admin:data_noisedataset_missing_analysis' %}"
           style="display: inline-block; padding: 8px 16px; background-color: #007cba; color: white; text-decoration: none; border-radius: 3px; margin-right: 10px;">
          🔍 View Details
        </a>
        <a href="{% url 'admin:data_noisedataset_redo_analysis' %}"
           style="display: inline-block; padding: 8px 16px; background-color: #ffc107; color: #212529; text-decoration: none; border-radius: 3px;">
          🔄 Reprocess All
        </a>
      </div>
    </div>
  {% endif %}

  {{ block.super }}
{% endblock %}
